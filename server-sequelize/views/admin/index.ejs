<div class="row">
    <div class="col-lg-12">
        <div class="jumbotron bg-success text-light">
            <h1 class="display-4">Dashboard</h1>
            <p class="lead">Ini adalah overview dari <%= data.siteTitle %>.</p>
            <hr class="my-4">
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h3 class="">Statistics</h3>
            </div>
            <div class="card-body">
                <canvas id="chLine"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="space-30"></div>

<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h3 class="">Recent Pastes</h3>
            </div>
            <div class="card-body" style="min-height: 357px; max-height: 357px; overflow-y: scroll;">
                <ul class="list-group list-group-flush">
                    <% data.results.forEach(function(result){ %>
                    <a href="<%= data.baseURL %>/edit/<%= result.editSlug %>" target="_blank"
                        class="list-group-item list-group-item-action">
                        <div class="d-flex w-100 justify-content-between">
                            <h5 class="mb-1"><%= result.title %></h5>
                        </div>
                        <p class="mb-1"><%= getTheExcerpt(result.content) %></p>
                        <small><%= result.createdAt %></small> <br />
                        <small class="text-muted"><i>Expired in <%= result.expiry %>(s), <%= result.hits %>
                                hit(s)</i></small>
                    </a>
                    <% }); %>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
    $.post("/admin", function (data) {
        let keys = [];
        let vals = [];

        for (let item of data) {
            keys.push(item.key);
            vals.push(item.value);
        }

        var colors = ['#007bff', '#28a745', '#333333', '#c3e6cb', '#dc3545', '#6c757d'];

        var chLine = document.getElementById("chLine");
        var chartData = {
            labels: keys,
            datasets: [{
                data: vals,
                backgroundColor: colors[3],
                borderColor: colors[1],
                borderWidth: 4,
                pointBackgroundColor: colors[1],
                label: "Number Of Paste Created"
            }]
        };

        if (chLine) {
            new Chart(chLine, {
                type: 'line',
                data: chartData,
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    },
                    legend: {
                        display: true
                    }
                }
            });
        }
    });
</script>