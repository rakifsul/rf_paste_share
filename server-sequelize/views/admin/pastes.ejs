<div class="row">
    <div class="col-lg-12">
        <div class="jumbotron bg-success text-light">
            <h1 class="display-4">Paste List</h1>
            <p class="lead">Paste list yang dibuat user. Anda bisa mengedit dan menghapus paste yang Anda inginkan di
                sini.</p>
            <hr class="my-4">
            <a class="btn btn-light btn-lg" href="<%= data.baseURL %>" target="_blank" role="button">New Paste</a>
        </div>
        <table id="pastes" class="table table-striped">
            <thead>
                <tr>
                    <th scope="col" style="width: 25%">Title</th>
                    <th scope="col" style="width: 25%">Content</th>
                    <th scope="col" style="width: 15%">Action</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
</div>
<script>
    function makeActions(data, type, dataToSet) {
        return `<a class="btn btn-primary btn-sm" href="<%= data.baseURL %>/view/${data.slug}" target="_blank">View</a>
        |
        <a class="btn btn-success btn-sm" href="<%= data.baseURL %>/edit/${data.editSlug}" target="_blank">Edit</a> 
        |
        <a class="btn btn-danger btn-sm" href="<%= data.baseURL %>/admin/paste/delete/${data.editSlug}">Delete</a>`
    }

    function getTheExcerpt(data) {
        if (data.content.length < 100) {
            return data.content.substring(0, data.content.length);
        }
        return data.content.substring(0, 100);
    }

    $(document).ready(function () {
        let t = $('#pastes').DataTable({
            "paging": true,
            "pageLength": 10,
            "searching": true,
            "processing": true,
            "serverSide": true,
            'ajax': {
                'type': 'POST',
                'url': '/admin/paste/list',
                'dataSrc': "data"
            },
            'columns':
                [
                    { 'data': 'title', "defaultContent": "", 'name': 'Title' },
                    { 'data': getTheExcerpt, "defaultContent": "", 'name': 'Content' },
                    { 'data': makeActions, "defaultContent": "", 'name': 'Action' }
                ],
            "columnDefs": [
                {
                    "searchable": true,
                    "orderable": false,
                    "targets": 0
                }
            ]
        });
    });
</script>